
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>CESA</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<!--    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">-->
    <link href="css/bootstrap_dark.css" rel="stylesheet" id="bootstrap-css">
    <link href="css/cesa.css" rel="stylesheet">
    <link rel="icon" 
      type="image/png" 
      href="./images/favicon.png" />
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.4.2.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script>
    
    function check()
        {
            var currentUser = Parse.User.current();
            if (currentUser) {
                window.location.assign("maps.html")
            } else {
                // show the signup or login page
            }
        }
    
    
    </script>

</head>
<body onload="check()">
	<center>
						<h1>CESA</h1>
        <h2>Cloud Enabled Smart Ambulance</h2>
						</center>
	<div class="container">
        <div class="modal fade" id="forgetModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <div class="text-center">
                          <h2 class="text-center">Forgot Password?</h2>
                          <p>You can reset your password here.</p>
                    </div>
                </div>
              <div class="modal-body">
                <form class="form" name="forgot" onsubmit="return forgot()">
                                <fieldset>
                                  <div class="form-group">
                                    <div class="input-group">
                                      <span class="input-group-addon"><i class="glyphicon glyphicon-envelope color-blue"></i></span>
                                      
                                      <input id="emailInput" placeholder="email address" class="form-control" type="email" oninvalid="setCustomValidity('Please enter a valid email address!')" onchange="try{setCustomValidity('')}catch(e){}" required="">
                                    </div>
                                  </div>
                                  <div class="form-group">
                                    <input class="btn btn-lg btn-primary btn-block" value="Send My Password" type="submit">
                                  </div>
                                </fieldset>
                </form>
                </div>
              </div>
            </div>
        </div>
    	<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<div class="panel panel-login">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<a href="#" class="active" id="login-form-link">Login</a>
							</div>
							<div class="col-xs-6">
								<a href="#" id="register-form-link">Register</a>
							</div>
						</div>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-lg-12">
								<form id="login-form" action="/maps.html" method="post" role="form" style="display: block;" onsubmit="return login()">
									<div class="form-group">
										<input type="text" name="username" id="user" tabindex="1" class="form-control" placeholder="Username" value="">
									</div>
									<div class="form-group">
										<input type="password" name="password" id="pass" tabindex="2" class="form-control" placeholder="Password">
									</div>
									<div class="form-group text-center">
										<input type="checkbox" tabindex="3" class="" name="remember" id="remember">
										<label for="remember"> Remember Me</label>
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-login" value="Log In">
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-lg-12">
												<div class="text-center">
													<a href="" tabindex="5" data-target="#forgetModal" class="forgot-password" data-toggle="modal">Forgot Password?</a>
												</div>
											</div>
										</div>
									</div>
                                    <div class="form-group">
										<span id="f"></span>
									</div>
								</form>
								<form id="register-form" action="#" method="post" role="form" style="display: none;" onsubmit="return sign()">
									<div class="form-group">
										<input type="text" name="username" id="username" tabindex="1" class="form-control" placeholder="Username" value="" required>
									</div>
									<div class="form-group">
										<input type="email" name="email" id="email" tabindex="1" class="form-control" placeholder="Email Address" value="" required>
									</div>
									<div class="form-group">
										<input type="password" name="password" id="password" tabindex="2" class="form-control" placeholder="Password" required>
									</div>
									<div class="form-group">
										<input type="password" name="confirm-password" id="confirm-password" tabindex="2" class="form-control" placeholder="Confirm Password" required>
									</div>
									<div class="form-group">
										<input type="string" name="Phone" id="phone" tabindex="2" class="form-control" placeholder="8888888888" required>
									</div>
                                    <div class="form-group">
										<input type="string" name="emgphn" id="emgphn" tabindex="2" class="form-control" placeholder="Emergency Contact No." required>
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit" name="register-submit" id="register-submit" tabindex="4" class="form-control btn btn-register" value="Register Now">
											
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<script type="text/javascript">
		
		Parse.initialize("6Newz3ChknhFDA0IRvtFVBEV6wkHEJtGjagAKfgY", "mpPOPAdgD2dhoqOuCu6zw3qwipx5wxFL9S0aGNzb");
		function sign()
		{
			var signUp = document.forms["register-form"];
			alert(document.getElementById("username").value);
			usr=document.getElementById("username").value;
			pass=document.getElementById("password").value;
			uemail=document.getElementById("email").value;
			phn=document.getElementById("phone").value;
			ephn=document.getElementById("emgphn").value;
			var user = new Parse.User();
			user.set("username", usr);
			user.set("password",pass);
			user.set("email", uemail);

			// other fields can be set just like with Parse.Object
			user.set("phone", parseInt(phn));
            user.set("emgphone", parseInt(ephn));

			user.signUp(null, {
			  success: function(user) {
				// Hooray! Let them use the app now.
				alert("Horray You Signed Up!!");
                  location.reload();
                  
				  return true;
			  },
			  error: function(user, error) {
				// Show the error message somewhere and let the user try again.
				alert("Error: " + error.code + " " + error.message);
				  return false;
		  }
		});
			event.preventDefault();
		}
		
        function forgot()
        {
            Parse.initialize("6Newz3ChknhFDA0IRvtFVBEV6wkHEJtGjagAKfgY", "mpPOPAdgD2dhoqOuCu6zw3qwipx5wxFL9S0aGNzb");
            //var em=prompt("Please enter your Email", "@gmail.com");
            //alert(em);
            em=document.getElementById("emailInput").value;
            Parse.User.requestPasswordReset(em, {
   success: function() {
       alert("Email containing Instructions has been sent!");
  // Password reset request was sent successfully
  },
  error: function(error) {
    // Show the error message somewhere
    alert("Error: " + error.code + " " + error.message);
  }
});
        }
        
		function login()
		{
			
			Parse.User.logIn(document.getElementById("user").value,document.getElementById("pass").value, {
  			success: function(user, success) {
				// Do stuff after successful login.
				window.location.assign("maps.html")
				return true;
				
			  },
			  error: function(user, error) {
				// The login failed. Check error to see why.
				  alert("Loggin Failed!");
				  return false;
			  }
			});		
				event.preventDefault();
			
		}
		
	</script>
	<script type="text/javascript">
		
	$(function() {

    $('#login-form-link').click(function(e) {
		$("#login-form").delay(100).fadeIn(100);
 		$("#register-form").fadeOut(100);
		$('#register-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});
	$('#register-form-link').click(function(e) {
		$("#register-form").delay(100).fadeIn(100);
 		$("#login-form").fadeOut(100);
		$('#login-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});

});

	</script>
    <script>
    function forgotIn()
        { 
            document.getElementById("f").innerHTML='<input type="email" name="email" id="email" tabindex="2" class="form-control" placeholder="Password"><input><div class="row"><div class="col-sm-6 col-sm-offset-3"><input type="submit" name="Submit" id="submit" tabindex="4" onclick="forgot()" class="form-control btn btn-login" value="Log In"></div></div>';
        }
    </script>
</body>
</html>
